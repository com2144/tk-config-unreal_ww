# This file is based on templates provided and copyrighted by Autodesk, Inc.
# This file has been modified by Epic Games, Inc. and is subject to the license
# file included in this repository.

################################################################################

publish_help_url: &help_url "https://support.shotgunsoftware.com/hc/en-us/articles/115000068574-Integrations-User-Guide#The%20Publisher"

includes:
- ../../app_locations.yml
#원래 코드-> config로만 수정
settings.tk-multi-publish2.unreal.project:
  collector: "{self}/collector.py:{engine}/tk-multi-publish2/basic/collector.py"
  publish_plugins:
  - name: Publish to ShotGrid
    hook: "{self}/publish_file.py"
    settings: {}
  - name: Upload for review
    hook: "{self}/upload_version.py"
    settings: {}
  - name: Publish to ShotGrid
    hook: "{self}/publish_file.py:{config}/hooks/tk-multi-publish2/basic/publish_session.py"
    settings: {}
  - name: Export FBX and Publish to ShotGrid
    hook: "{self}/publish_file.py:{config}/hooks/tk-multi-publish2/basic/publish_asset.py"
    settings:
        Publish Template: unreal.asset_publish
        Additional Fields:
            sg_asset_type: "{context.entity.sg_asset_type}"
            Asset: "{context.entity.code}"
            Step: "{context.step.name}"
  - name: Render Movie and Submit for Review
    hook: "{self}/publish_file.py:{config}/hooks/tk-multi-publish2/basic/publish_movie.py"
    settings:
        Publish Template: unreal.movie_publish
  help_url: *help_url
  location: "@apps.tk-multi-publish2.location"

# settings.tk-multi-publish2.unreal.project:
#   collector: "{self}/collector.py:{engine}/tk-multi-publish2/basic/collector.py"
#   publish_plugins:
#   - name: Publish to ShotGrid
#     hook: "{self}/publish_file.py"
#     settings: {}
#   - name: Upload for review
#     hook: "{self}/upload_version.py"
#     settings: {}
#   - name: Begin file versioning
#     hook: "{config}/hooks/tk-multi-publish2/basic/start_version_control.py"
#     settings: {}
#   # Additional publish plugins (commented out for future reference)
#   # - name: Publish to ShotGrid
#   #   hook: "{self}/publish_file.py:{engine}/tk-multi-publish2/basic/publish_session.py"
#   #   settings: {}
#   # - name: Export FBX and Publish to ShotGrid
#   #   hook: "{self}/publish_file.py:{config}/hooks/tk-multi-publish2/basic/publish_asset.py"
#   #   settings:
#   #     Publish Template: unreal.asset_publish
#   #     Additional Fields:
#   #       sg_asset_type: "{context.entity.sg_asset_type}"
#   #       Asset: "{context.entity.code}"
#   #       Step: "{context.step.short_name}"
#   # - name: Render Movie and Submit for Review
#   #   hook: "{self}/publish_file.py:{engine}/tk-multi-publish2/basic/publish_movie.py"
#   #   settings:
#   #     Publish Template: unreal.movie_publish
#   help_url: *help_url
#   location: "@apps.tk-multi-publish2.location"

# Original Maya asset step settings (commented out for backup)
# settings.tk-multi-publish2.maya.asset_step.unreal:
#   collector: "{self}/collector.py:{engine}/tk-multi-publish2/basic/collector.py:{tk-framework-unrealqt_v1.x.x}/tk-multi-publish2/tk-maya/basic/collector.py"
#   collector_settings:
#       Work Template: maya_asset_work
#   publish_plugins:
#   - name: Publish to ShotGrid
#     hook: "{self}/publish_file.py"
#     settings: {}
#   - name: Upload for review
#     hook: "{self}/upload_version.py"
#     settings: {}
#   - name: Begin file versioning
#     hook: "{engine}/tk-multi-publish2/basic/start_version_control.py"
#     settings: {}
#   - name: Publish to ShotGrid
#     hook: "{self}/publish_file.py:{engine}/tk-multi-publish2/basic/publish_session.py"
#     settings:
#         Publish Template: maya_asset_publish
#   - name: Export FBX for Unreal
#     hook: "{config}/hooks/tk-multi-publish2/basic/publish_asset.py"
#     settings:
#         Publish Template: unreal.maya_asset_fbx_publish
#         Export Type: FBX
#         Additional Fields:
#             sg_asset_type: "{context.entity.sg_asset_type}"
#             Asset: "{context.entity.code}"
#             Step: "{context.step.short_name}"
#   - name: Publish to ShotGrid
#     hook: "{self}/publish_file.py:{engine}/tk-multi-publish2/basic/publish_session_geometry.py"
#     settings:
#         Publish Template: asset_alembic_cache
#   - name: Publish FBX to ShotGrid
#     hook: "{self}/publish_file.py:{tk-framework-unrealqt_v1.x.x}/tk-multi-publish2/tk-maya/basic/publish_fbx.py"
#     settings:
#         Publish Template: unreal.maya_asset_fbx_publish
#   - name: Publish and Submit for Review
#     hook: "{self}/publish_file.py:{tk-framework-unrealqt_v1.x.x}/tk-multi-publish2/tk-maya/basic/publish_turntable.py"
#     settings:
#         Work Template: unreal.maya_turntable_render
#         Publish Template: unreal.maya_turntable_publish
#         Unreal Engine Version: "5.3"
#         Unreal Project Path Template: "{self}/resources/ueprojects/{unreal_engine_version}/turntable/turntable.uproject"
#         Turntable Map Path: "/Game/turntable/level/turntable.umap"
#         Sequence Path: "/Game/turntable/sequence/turntable_sequence.turntable_sequence"
#         Turntable Assets Path: "/Game/maya_turntable_assets"
#   help_url: *help_url
#   location: "@apps.tk-multi-publish2.location"

# New Maya asset step settings
settings.tk-multi-publish2.maya.asset_step.unreal:
  collector: "{self}/collector.py:{engine}/tk-multi-publish2/basic/collector.py"
  collector_settings:
      Work Template: maya_asset_work
  publish_plugins:
  - name: Publish to ShotGrid
    hook: "{self}/publish_file.py"
    settings: {}
  - name: Upload for review
    hook: "{self}/upload_version.py"
    settings: {}
  - name: Begin file versioning
    hook: "{engine}/tk-multi-publish2/basic/start_version_control.py"
    settings: {}
  - name: Publish to ShotGrid
    hook: "{self}/publish_file.py:{engine}/tk-multi-publish2/basic/publish_session.py"
    settings:
        Publish Template: maya_asset_publish
  - name: Export FBX for Unreal
    hook: "{config}/hooks/tk-multi-publish2/basic/publish_asset.py"
    settings:
        Publish Template: unreal.maya_asset_fbx_publish
        Export Type: FBX
        Additional Fields:
            sg_asset_type: "{context.entity['sg_asset_type']}" #컨텍스트가져오기
            Asset: "{context.entity['code']}"
            Step: "{context.step['name']}"
  - name: Publish to ShotGrid
    hook: "{self}/publish_file.py:{engine}/tk-multi-publish2/basic/publish_session_geometry.py"
    settings:
        Publish Template: asset_alembic_cache
  - name: Publish FBX to ShotGrid
    hook: "{self}/publish_file.py:{tk-framework-unrealqt_v1.x.x}/tk-multi-publish2/tk-maya/basic/publish_fbx.py"
    settings:
        Publish Template: unreal.maya_asset_fbx_publish
  - name: Publish and Submit for Review
    hook: "{self}/publish_file.py:{tk-framework-unrealqt_v1.x.x}/tk-multi-publish2/tk-maya/basic/publish_turntable.py"
    settings:
        Work Template: unreal.maya_turntable_render
        Publish Template: unreal.maya_turntable_publish
        Unreal Engine Version: "5.3"
        Unreal Project Path Template: "{self}/resources/ueprojects/{unreal_engine_version}/turntable/turntable.uproject"
        Turntable Map Path: "/Game/turntable/level/turntable.umap"
        Sequence Path: "/Game/turntable/sequence/turntable_sequence.turntable_sequence"
        Turntable Assets Path: "/Game/maya_turntable_assets"
  help_url: *help_url
  location: "@apps.tk-multi-publish2.location"
